<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="../css/especie.css">
    <title>Dinossauros</title>
</head>

<body onload="listarEspecies()">
    <div class="caixa-cadastro-dino">
        <h1>CADASTRAR ESPÉCIE</h1>
        <p>NOME</p>
        <input id="input_nome">
        <p>erro</p>
        <p>NOME CIENTIFICO</p>
        <input id="input_nome_cientifico">
        <p>erro</p>
        <p>dieta</p>
        <input id="input_dieta">
        <p id="msg_erro">erro</p>
        <button onclick="cadastrarEspecie()">CADASTRAR</button>
    </div>
    <div class="especie-container">
        <aside class="menu-lateral">
            <section class="sessao-botoes-superiores">
                <img src="../assets/logo_pequena.png" alt="logo" class="logo-menu">
                <button class="botao-menu">
                    <span class="material-symbols-outlined">Home</span>
                </button>
                <button class="botao-menu" onclick="navegar('./dashboardCli.html')">
                    <span class="material-symbols-outlined icone-dna">Genetics</span>
                </button>
                <button class="botao-menu">
                    <span class="material-symbols-outlined">Shop</span>
                </button>
                <button class="botao-menu">
                    <span class="material-symbols-outlined">Perm_Phone_Msg</span>
                </button>
            </section>
            <section class="sessao-botao-inferior">
                <button class="botao-menu" onclick="limparSessao()">
                    <span class="material-symbols-outlined">Logout</span>
                </button>
            </section>
        </aside>
        <aside class="conteudo-dashboardCli">
            <section class="conteudo-esquerdo">
                <header class="cabecalho-esquerdo">
                    <h1>ESPÉCIES</h1>
                </header>
                <div class="caixa-lista-dino">
                    <section class="titulo-tabela">
                        <h3 class="titulos">NOME</h3>
                        <h3 class="titulos">NOME CIENTIFICO</h3>
                        <h3 class="titulos">DIETA</h3>
                        <h3 class="titulos">QUANTIDADE</h3>
                    </section>
                    <section class="lista-dino" id="div_lista_dino"></section>
                    <button class="botao-add-especie">ADICIONAR ESPÉCIE</button>
                </div>
            </section>
            <section class="conteudo-direito">
                <header class="cabecalho-direito">
                    <h1 class="titulo-curiosidade">CURIOSIDADES</h1>
                    <div class="conteudo-curiosidade">
                        <p>aaaaa</p>
                    </div>
                </header>
                <div class="caixa-grafico">
                    <h1 class="titulo-grafico">GRÁFICO</h1>
                    <canvas id="grafico_dinos" class="grafico"></canvas>
                </div>
            </section>
        </aside>
    </div>
</body>

</html>
<script>
    const listaDino = [];

    function listarEspecies() {
        fetch("/especie/listarEspecie", {
            method: "GET",
        }).then(function (resposta) {
            resposta.json().then((especie) => {
                especie.forEach((especie) => {
                    listaDino.push(especie.nomeEspecie);


                    div_lista_dino.innerHTML += `
                    <section class="card-dino">
                        <span class="dado-dino">${especie.nomeEspecie}</span>
                        <span class="dado-dino">${especie.nomeCientifico}</span>
                        <span class="dado-dino">${especie.dieta}</span>
                        <span class="dado-dino">4</span>
                    </section>
                    `;
                }).catch(function (resposta) {
                    console.log(`#ERRO: ${resposta}`);
                });
            }
            )
        })
    }

    function cadastrarEspecie() {
        var nomeEspecieVar = input_nome.value;
        var nomeEspecieCientificoVar = input_nome_cientifico.value;
        var dietaEspecieVar = input_dieta.value;

        if (nomeEspecieVar == '' || nomeEspecieCientificoVar == '' || dietaEspecieVar == '') {
            msg_erro.innerHTML = 'Preencha todos os campos!'

            return false;
        } else {
            fetch('/especie/cadastrarEspecie', {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    nomeEspecie: nomeEspecieVar,
                    nomeCientifico: nomeEspecieCientificoVar,
                    dieta: dietaEspecieVar,
                })
            })
                .then(function (resposta) {
                    console.log("resposta: ", resposta);

                    if (resposta.ok) {
                        msg_erro.style.color = '#1351F1'
                        msg_erro.innerHTML =
                            "Cadastro realizado com sucesso!";
                    } else {
                        throw "Houve um erro ao tentar realizar o cadastro!";
                    }
                }).catch(function (resposta) {
                    console.log(`#ERRO: ${resposta}`);
                });

            return false;
        }
    }
</script>